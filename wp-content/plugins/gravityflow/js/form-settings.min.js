!function(a,b){"use strict";function c(a){var b={select:["rejection_notification_users","rejection_notification_from_name","rejection_notification_from_email","rejection_notification_reply_to","rejection_notification_bcc","rejection_notification_subject","rejection_notification_message","rejection_notification_gpdf","rejection_notification_autoformat"],routing:["rejection_notification_routing","rejection_notification_from_name","rejection_notification_from_email","rejection_notification_reply_to","rejection_notification_bcc","rejection_notification_subject","rejection_notification_message","rejection_notification_gpdf","rejection_notification_autoformat"]};g(b,a,!0)}function d(a){var b={select:["approval_notification_users","approval_notification_from_name","approval_notification_from_email","approval_notification_reply_to","approval_notification_bcc","approval_notification_subject","approval_notification_message","approval_notification_gpdf","approval_notification_autoformat"],routing:["approval_notification_routing","approval_notification_from_name","approval_notification_from_email","approval_notification_reply_to","approval_notification_bcc","approval_notification_subject","approval_notification_message","approval_notification_gpdf","approval_notification_autoformat"]};g(b,a,!0)}function e(a){var b={select:["workflow_notification_users\\[\\]","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat"],routing:["workflow_notification_routing","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat"]};g(b,a,!1)}function f(a){var b={select:["assignees\\[\\]","editable_fields\\[\\]","conditional_logic_editable_fields_enabled","unanimous_approval","assignee_policy"],routing:["routing","conditional_logic_editable_fields_enabled"]};g(b,a)}function g(a,c,d){var e=d?"#gaddon-setting-tab-field-":"#gaddon-setting-row-";b.each(a,function(a,c){b.each(c,function(a,c){b(e+c).hide()})}),b.each(a,function(a,d){c==a&&b.each(d,function(a,c){b(e+c).fadeToggle("normal")})})}function h(a){var d=b("#gaddon-setting-tab-field-rejection_notification_type");if(d.toggle(a),a){var e=d.find("input[type=radio]:checked").val();c(e),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-checked").show(),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-unchecked").hide()}else c("off"),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-checked").hide(),b("#gaddon-setting-tab-tab_rejection_notification i.gravityflow-tab-unchecked").show()}function i(a){var c=b("#gaddon-setting-tab-field-approval_notification_type");if(c.toggle(a),a){var e=c.find("input[type=radio]:checked").val();d(e),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-checked").show(),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-unchecked").hide()}else d("off"),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-checked").hide(),b("#gaddon-setting-tab-tab_approval_notification i.gravityflow-tab-unchecked").show()}function j(a){var c=b("#gaddon-setting-row-workflow_notification_type");if(c.toggle(a),a){var d=c.find("input[type=radio]:checked").val();e(d)}else e("off")}function k(){for(var a=["routing","assignees\\[\\]","unanimous_approval","assignee_notification_from_name","assignee_notification_from_email","assignee_notification_reply_to","assignee_notification_bcc","assignee_notification_subject","assignee_notification_message","assignee_notification_autoformat","resend_assignee_email","assignee_notification_gpdf","rejection_notification_type","rejection_notification_users\\[\\]","rejection_notification_user_field","rejection_notification_routing","rejection_notification_message","rejection_notification_autoformat","approval_notification_type","approval_notification_users\\[\\]","approval_notification_user_field","approval_notification_routing","approval_notification_message","approval_notification_autoformat","workflow_notification_type","workflow_notification_users\\[\\]","workflow_notification_user_field","workflow_notification_routing","workflow_notification_from_name","workflow_notification_from_email","workflow_notification_reply_to","workflow_notification_bcc","workflow_notification_subject","workflow_notification_message","workflow_notification_autoformat","assignees\\[\\]","editable_fields\\[\\]","conditional_logic_editable_fields_enabled","highlight_editable_fields","routing","assignee_policy","assignee_notification_message"],c=0;c<a.length;c++)b("#gaddon-setting-row-"+a[c]).addClass("gravityflow_sub_setting")}function l(a,b,c,d,e,f){var g=["_gaddon_setting_workflow_notification_message","_gaddon_setting_assignee_notification_message","_gaddon_setting_approval_notification_message","_gaddon_setting_rejection_notification_message"];if(g.indexOf(b)<0)return a;var h=[];return h.push({tag:"{workflow_entry_link}",label:"Entry Link"}),h.push({tag:"{workflow_entry_url}",label:"Entry URL"}),h.push({tag:"{workflow_inbox_link}",label:"Inbox Link"}),h.push({tag:"{workflow_inbox_url}",label:"Inbox URL"}),h.push({tag:"{workflow_cancel_link}",label:"Cancel Link"}),h.push({tag:"{workflow_cancel_url}",label:"Cancel URL"}),h.push({tag:"{workflow_note}",label:"Note"}),h.push({tag:"{workflow_timeline}",label:"Timeline"}),a.gravityflow={label:"Workflow",tags:h},a}function m(a,c,d,e,f,g){var h=["_gaddon_setting_assignee_notification_message"];if(h.indexOf(c)<0)return a;var i=[];return i.push({tag:"{workflow_approve_link}",label:"Approve Link"}),i.push({tag:"{workflow_reject_link}",label:"Reject Link"}),"undefined"!=typeof a.gravityflow?a.gravityflow.tags=b.merge(a.gravityflow.tags,i):a.gravityflow={label:"Workflow",tags:i},a}function n(){var a=gravityflow_form_settings_js_strings.feedId;if(a>0){var c=ajaxurl+"?action=gravityflow_feed_message&fid="+a+"&id="+gravityflow_form_settings_js_strings.formId;b.get(c,function(a){var c=b("#save_button");c.before(a)})}}b(document).ready(function(){window.gformInitDatepicker&&gformInitDatepicker(),b("#assignees, #editable_fields, #rejection_notification_users, #approval_notification_users, #workflow_notification_users, .gravityflow-multiselect-ui").multiSelect();var g=!1,l=!1;b("form#gform-settings").submit(function(){l=!0,b("form#gform-settings").find(":input").removeAttr("disabled")}),b(":input").change(function(){g=!0}),window.onbeforeunload=function(){if(g&&!l)return"You have unsaved changes."};var m=b("input[name=_gaddon_setting_step_type]:checked"),o=(m.val(),b("#status_expiration")),p="expired"==o.val();b("#expiration_sub_setting_destination_expired").toggle(p),o.change(function(){var a="expired"==b(this).val();b("#expiration_sub_setting_destination_expired").fadeToggle(a)}),k();var q=b("#assignee_notification_enabled"),r=b("#gaddon-setting-tab-field-assignee_notification_message");q.click(function(){r.fadeToggle("normal"),b("#gaddon-setting-tab-field-assignee_notification_from_name").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_from_email").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_reply_to").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_bcc").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_subject").fadeToggle(),b("#gaddon-setting-tab-field-resend_assignee_email").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_gpdf").fadeToggle(),b("#gaddon-setting-tab-field-assignee_notification_autoformat").fadeToggle(),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-checked").toggle(),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-unchecked").toggle()});var s=q.prop("checked");r.toggle(s),b("#gaddon-setting-tab-field-assignee_notification_from_name").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_from_email").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_reply_to").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_bcc").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_subject").toggle(s),b("#gaddon-setting-tab-field-resend_assignee_email").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_gpdf").toggle(s),b("#gaddon-setting-tab-field-assignee_notification_autoformat").toggle(s),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-checked").toggle(s),b("#gaddon-setting-tab-tab_assignee_notification i.gravityflow-tab-unchecked").toggle(!s);var t=b("#rejection_notification_enabled").prop("checked");h(t),b("#rejection_notification_enabled").click(function(){h(this.checked)});var u=b("input[name=_gaddon_setting_type]:checked");f(u.val()),b("#gaddon-setting-row-type input[type=radio]").change(function(){f(this.value)}),b("#gaddon-setting-tab-field-rejection_notification_type input[type=radio]").click(function(){c(this.value)}),b("#gaddon-setting-tab-field-approval_notification_type input[type=radio]").click(function(){d(this.value)});var v=b("#approval_notification_enabled").prop("checked");i(v),b("#approval_notification_enabled").click(function(){i(this.checked)}),b("#gaddon-setting-row-workflow_notification_type input[type=radio]").click(function(){e(this.value)});var w=b("#workflow_notification_enabled").prop("checked");j(w),b("#workflow_notification_enabled").click(function(){j(this.checked)}),a.getUsersMarkup=function(a){var b,c,d,e=gf_routing_setting_strings.accounts,f='<select class="gform-routing-users '+a+'_{i}">';for(b=0;b<e.length;b++)if(d=e[b],"undefined"!=typeof d.choices){var g,h="";for(c=0;c<d.choices.length;c++)g=d.choices[c],h+='<option value="{0}">{1}</option>'.format(g.value,g.label);f+='<optgroup label="{0}">{1}</option>'.format(d.label,h)}else f+='<option value="{0}">{1}</option>'.format(d.value,d.label);return f+="</select>"};var x,y=b("#gform_routing_setting"),z=b("#routing").val(),A=z?b.parseJSON(z):null;b("#editable_fields").length>0?(A||(A=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,editable_fields:[gf_routing_setting_strings.input_fields[0].key],fieldId:"0",operator:"is",value:"",type:""}],b("#user_input_routing").val(b.toJSON(A))),x={fieldName:y.data("field_name"),fieldId:y.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:A,callbacks:{addNewTarget:function(c,d){var e=a.getUsersMarkup("assignee"),f=b("#editable_fields").clone();f.attr("name","editable_fields");b("#gform-routings tbody tr").length;return f.attr("id","editable_fields_routing_{i}"),f.attr("style",""),f.addClass("gform-routing-input-field editable_fields_{i}"),e+="</td><td>"+f[0].outerHTML},header:function(a,b){return'<thead><tr><th>Assign To</th><th>Editable Fields</th><th colspan="3">Condition</th></tr></thead>'}}}):(A||(A=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#routing").val(b.toJSON(A))),x={fieldName:y.data("field_name"),fieldId:y.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:A,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}}),y.gfRoutingSetting(x);var B=b("#gform_user_routing_setting_rejection_notification_routing"),C=b("#rejection_notification_routing").val(),D=C?b.parseJSON(C):null;D||(D=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#approval_rejection_notification_routing").val(b.toJSON(D)));var E={fieldName:B.data("field_name"),fieldId:B.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:D,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};B.gfRoutingSetting(E);var F=b("#gform_user_routing_setting_approval_notification_routing"),G=b("#approval_notification_routing").val(),H=G?b.parseJSON(G):null;H||(H=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#approval_notification_routing").val(b.toJSON(H)));var I={fieldName:F.data("field_name"),fieldId:F.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:H,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};F.gfRoutingSetting(I);var J=b("#gform_user_routing_setting_workflow_notification_routing"),K=b("#workflow_notification_routing").val(),L=K?b.parseJSON(K):null;L||(L=[{assignee:gf_routing_setting_strings.accounts[0].choices[0].value,fieldId:"0",operator:"is",value:"",type:""}],b("#workflow_notification_routing").val(b.toJSON(L)));var M={fieldName:J.data("field_name"),fieldId:J.data("field_id"),settings:gf_routing_setting_strings.fields,accounts:gf_routing_setting_strings.accounts,imagesURL:gf_vars.baseUrl+"/images",items:L,callbacks:{addNewTarget:function(b,c){var d=a.getUsersMarkup("assignee");return d}}};J.gfRoutingSetting(M),window.gform&&gform.addFilter("gform_merge_tags",a.gravityflow_add_merge_tags),window.gformInitDatepicker&&gformInitDatepicker(),n()}),a.gravityflow_add_merge_tags=function(a,b,c,d,e,f){return e?a:(l(a,b,c,d,e,f),m(a,b,c,d,e,f),a)}}(window.GravityFlowFeedSettings=window.GravityFlowFeedSettings||{},jQuery);